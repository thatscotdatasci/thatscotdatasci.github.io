---
layout: default
title: Python 3.9 Features
date: 2020-12-01
display-date: Y
categories: [ Learning ]
tags: [ Python ]
---

Hot on the heels of my [post about the new features in Python 3.8]({% post_url 2020-11-30-python_3_8_features %}),
here's a roundup of the new features in Python 3.9.

This information is primarily from [Real Python](https://realpython.com/courses/cool-new-features-python-39/)
and the [Python documentation](https://docs.python.org/3/whatsnew/3.9.html).

## zoneinfo Library

By default, `datetime` objects have no timezone information. Timestamps without timezone information are called *naive*.

It was possible to pass the `tz` parameter into methods such as `timezone.now()` to associate the returned timestamp with
a timezone, however prior to python 3.9 the only timezone that was provided out-of-the-box was UTC (others had to be
implemented manually, or imported from third-party libraries).

Python 3.9 introduces the `zoneinfo` module, which contains a `ZoneInfo` class that accesses the computer's time zone
database and makes that information available in the code. Timezones can be specified by name, and the module handles zone
name changes during daylight savings time.

```python
from datetime import datetime
from zoneinfo import ZoneInfo

datetime.now(tz=ZoneInfo("Europe/London"))
# datetime.datetime(2020, 12, 2, 11, 30, 0, 717862, tzinfo=zoneinfo.ZoneInfo(key='Europe/London'))

# Convert times between timezones
_.astimezone(ZoneInfo("Europe/Moscow"))  # Using underscore to access previous expression result
# datetime.datetime(2020, 12, 2, 14, 30, 0, 717862, tzinfo=zoneinfo.ZoneInfo(key='Europe/Moscow'))
```

**Note:** Remember that the information is coming from a database on the computer. Therefore, the available timezones will
change from operating system to operating system. Windows does not have a suitable database at all!

Therefore, need to make sure the `tdzata` version of the database provided as a Python library ([Git repo](https://github.com/python/tzdata))
is installed:

```shell_script
pip install tzdata
```
Real Python makes the following recommendations for best practices with timezones:

- **Civil times** should have a specified timezone
  - These are events that occur in a physical location - like meetings, train times, concerts, etc.
  - Thus, `datetime` objects should be associated with the timezone appropriate to the location
- **Timestamps** should be naive and based on UTC
  - Things like server logs, etc.
  - UTC is always monotonically increasing - you don't want to have to adjust the order of events based on timezone changes
  (daylight savings, etc.)

